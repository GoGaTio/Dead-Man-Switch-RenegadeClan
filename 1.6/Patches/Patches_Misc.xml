<?xml version="1.0" encoding="utf-8" ?>

<Patch>

  <Operation Class="PatchOperationInsert">
    <xpath>Defs/ThinkTreeDef[defName="DMS_Mechanoid"]/thinkRoot/subNodes/li[@Class="ThinkNode_ConditionalPlayerControlledMech"]/subNodes/li[@Class="ThinkNode_ConditionalNotFormingCaravan"]/subNodes/li[@Class ="ThinkNode_ConditionalRecharging"]</xpath>
    <order>Append</order>
    <value>
      <li Class="DMSRC.JobGiver_RepairMechs" />
    </value>
  </Operation>

  <Operation Class="PatchOperationConditional">
    <xpath>Defs/FactionDef[defName="Empire"]/permanentEnemyToEveryoneExcept</xpath>
    <match Class="PatchOperationAdd">
      <xpath>Defs/FactionDef[defName="Empire"]/permanentEnemyToEveryoneExcept</xpath>
      <value>
        <li>DMSRC_PlayerRenegades</li>
        <li>DMSRC_RenegadeClan</li>
      </value>
    </match>
  </Operation>

  <Operation Class="PatchOperationConditional">
    <xpath>Defs/ResearchProjectDef[defName="WG_HeavyExoskeleton" or defName="DMS_MobileDragoon" or defName="DMS_MobileDragoonAdvanced" or defName="DMS_MobileDragoonElite" or defName="DMS_MobileDragoonModule" or defName="DMS_ExperimentalGear"]/heldByFactionCategoryTags</xpath>
    <match Class="PatchOperationAdd">
      <xpath>Defs/ResearchProjectDef[defName="WG_HeavyExoskeleton" or defName="DMS_MobileDragoon" or defName="DMS_MobileDragoonAdvanced" or defName="DMS_MobileDragoonElite" or defName="DMS_MobileDragoonModule" or defName="DMS_ExperimentalGear"]/heldByFactionCategoryTags</xpath>
      <value>
        <li>DMSRC_RenegadeClan</li>
      </value>
    </match>
  </Operation>

  <Operation Class="PatchOperationAdd">
    <xpath>Defs/TraderKindDef[defName="DMS_Caravan_TributeCollector"]/stockGenerators</xpath>
    <value>
      <li Class="StockGenerator_BuySingleDef">
        <thingDef>DMSRC_ProcessorCore</thingDef>
      </li>
      <li Class="StockGenerator_BuySingleDef">
        <thingDef>DMSRC_ComponentGBEP</thingDef>
      </li>
    </value>
  </Operation>

  <Operation Class="PatchOperationAdd">
    <xpath>Defs/ThingDef[thingClass="Building_CommsConsole"]/comps</xpath>
    <value>
      <li Class="DMSRC.CompProperties_CallRenegades">
        <useJob>DMSRC_TalkToRenegades</useJob>
        <floatMenuOptionPriority>InitiateSocial</floatMenuOptionPriority>
      </li>
    </value>
  </Operation>
  
  <Operation Class="PatchOperationAdd">
    <xpath>Defs/ScenarioDef[defName="DMS_Scenario" or defName="DMSMD_Scenario"]/scenario/parts</xpath>
    <value>
      <li Class="DMSRC.ScenPart_Renegades">
        <def>DMSRC_Renegades</def>
        <relations>Hostile</relations>
        <goodwill>-200</goodwill>
      </li>
    </value>
  </Operation>

</Patch>